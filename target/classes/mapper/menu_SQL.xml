<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="menu">

	<select id="menuList" parameterType="hashmap"
		resultType="hashmap">
<![CDATA[
		SELECT  p.*,s.S_SO  
		 FROM 
		 	PRODUCT p , STATUS s
		 WHERE p.P_IDX=s.SP_IDX AND s.SS_IDX=${STORE}	
]]>

	</select>
	<select id="mainmenuList" parameterType="hashmap"
		resultType="hashmap">
<![CDATA[
	SELECT AA.* FROM (
		SELECT  ROW_NUMBER() OVER(ORDER BY P_IDX DESC) RNUM ,p.*
		 FROM 
		 	PRODUCT p ) AA
		 	WHERE RNUM < 7
]]>

	</select>
	<select id="productList" parameterType="hashmap"
		resultType="hashmap">
<![CDATA[
		SELECT  P_IDX 
		 FROM 
		 			PRODUCT
		 
]]>

	</select>
	<select id="menuDetail" parameterType="hashmap"
		resultType="hashmap">
<![CDATA[
      SELECT  
         * 
      FROM 
         PRODUCT
      WHERE
         P_IDX = #{P_IDX}
]]>
	</select>

	<insert id="insertCart" parameterType="hashmap">
		INSERT INTO
		CART
		(CP_NAME,C_PRICE, C_OP,C_IDX, C_STORE, CB_IDX, CP_IDX, C_COUNT,
		CP_IMG)
		VALUES (
		#{CP_NAME},
		#{C_PRICE},
		#{C_OP},
		C_IDX_SEQ.NEXTVAL,
		#{C_STORE},
		#{CB_IDX},
		#{CP_IDX},
		#{C_COUNT},
		#{CP_IMG}

		)
	</insert>


	<select id="cartList" parameterType="hashmap"
		resultType="hashmap">
<![CDATA[
		SELECT  C.*,S.* 
		 FROM 
		 CART C, S_MEMBER S
		 WHERE
		 C.C_STORE=S.STORE
		 AND
		 CB_IDX=#{B_PHONE}
		 
]]>

	</select>
	
	

	<update id="updateCart" parameterType="hashmap">
		UPDATE CART SET
		C_PRICE=${UP_PRICE}, C_COUNT=${UP_COUNT} WHERE C_IDX=${UP_CIDX}
	</update>

	<delete id="cartDeleteAll" parameterType="hashmap">
		DELETE FROM CART WHERE CB_IDX=${B_PHONE}
	</delete>

	<delete id="cartDelete" parameterType="hashmap">
		DELETE FROM CART WHERE C_IDX=${C_IDX}
	</delete>
</mapper>